
<html>
    <head>
        <title>Ручное тестирование примеров, связанных с элементами интерфейса</title>
        
        <script src="../src/Requests1.js"></script>
        <script src="../src/Requests2.js"></script>
        <script src="../src/Signatures.js"></script>
        <script src="../src/CryptoOperations.js"></script>
        <script src="../src/Providers.js"></script>
        <script src="../src/Profiles.js"></script>
    </head>
<body>
    
    <div style="margin:10px;">
        Ручное тестирование примеров, связанных с элементами интерфейса
        
        <hr />
        <div>
            <p>Создание запроса на сертификат в интерактивном режиме</p>
            <p><button onclick="CreateCertificateRequestInteractive();">Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Создание самоподписанного сертификата</p>
            <p><button onclick="CreateSelfSignedCert();">Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Вызов мастера сбора данных для создания PKI запроса<br />
            Создание, отправка, сохранение запроса в интерактивном (GUI) режиме.</p>
            <p><button onclick="CreatePKIRequestWithWizard();">Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Создание самоподписанного сертификата в silent режиме</p>
            <p><button onclick="CreateSelfSignedCertificate();">Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Подпись содержимого формы</p>
            <p><form id="TextToSign">
                <input type="text" name="inText" value="Some text to sign"/><br />
                <input type="text" name="outSign" value=""/>
            </form></p>
            <p><button onclick='document.getElementById("TextToSign").elements[1].value = SignText(document.getElementById("TextToSign").elements[0].value);'>Запуск</button></p>
            <script language=javascript>
                function TestSignFromForm( strSign, strPlain )
                {
                    var oFso = new ActiveXObject("Scripting.FileSystemObject");
                    var tmpFileName = oFso.GetSpecialFolder(2) + "\\" + oFso.GetTempName();
                    
                    var file = oFso.CreateTextFile( tmpFileName, true, true );
                    file.Write(strPlain);
                    file.Close();
                    
                    var oMsg = new ActiveXObject("DigtCrypto.PKCS7Message");
                    oMsg.Import( 2, strSign, tmpFileName );
                    
                    alert( "Signature verification result: " + oMsg.Signatures.Item(0).Verify(1) + "\n1 is good, otherwise bad" );
                    
                    oFso.DeleteFile( tmpFileName );
                }
            </script>
            <p><button onclick='TestSignFromForm(document.getElementById("TextToSign").elements[1].value, document.getElementById("TextToSign").elements[0].value);'>Проверить результат</button></p>
        </div>

        <hr />
        <div>
            <p>Открытие окна управления PKCS7 данными</p>
            <p><form id="InputFiles">
                <table>
                    <tr>
                        <td>Выберите файл подписи:</td>
                        <td><input type="file" name="inFile" value=""/></td>
                    </tr>
                    <tr>
                        <td>Выберите шифрованный файл:</td>
                        <td><input type="file" name="outFile" value=""/></td>
                    </tr>
                </table>
            </form></p>
            <p><button onclick='OpenPkcs7MsgManagementWindow( document.getElementById("InputFiles").elements[0].value, document.getElementById("InputFiles").elements[1].value );'>Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Подключение отчуждаемого носителя</p>
            <p><button onclick="ConnectingKeyCarrier();">Запуск</button></p>
        </div>

        <hr />
        <div>
            <p>Пример вызова менеджера профилей</p>
            <p><button onclick="DisplayProfileManager();">Запуск</button></p>
        </div>
        <hr />
    </div>

</body>
</html>
